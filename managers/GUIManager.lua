--[[
	GUIManager
	
	Manages the GUI part of exploit.
]]--

---<< SERVICES >>---
local GuiService = game:GetService("GuiService")


---<< CONSTANTS >>---
local PlayerESPManager = shared.Loadstring("managers/PlayerESPManager.lua")()

local LinoriaRepos = "https://raw.githubusercontent.com/wally-rblx/LinoriaLib/main/"
local LinoriaLibrary = shared.Loadstring(LinoriaRepos .. "Library.lua", true)()
local SaveManager = shared.Loadstring(LinoriaRepos .. "addons/SaveManager.lua", true)()
local ThemeManager = shared.Loadstring(LinoriaRepos .. "addons/ThemeManager.lua", true)()


---<< MODULE >>---
local GUIManager = {}

GUIManager.LinoriaLibrary = LinoriaLibrary
GUIManager.ESPLibrary = PlayerESPManager.ESPLibrary
GUIManager.PlayerESPManager = PlayerESPManager
GUIManager.SaveManager = SaveManager
GUIManager.ThemeManager = ThemeManager

function GUIManager:CreateWindow(gameName)
    return LinoriaLibrary:CreateWindow({
        Title = tostring("ASYExploit - " .. tostring(gameName)),
        Center = true,
        AutoShow = true
    })
end

function GUIManager:BuildSettings(Window, gameFolderName)
    local tab = Window:AddTab("Settings")
    local menuBox = tab:AddLeftGroupbox("Menu")

    menuBox:AddButton("Unload", function()
        LinoriaLibrary:Unload()
    end)
    menuBox:AddLabel("Toggle GUI Keybind"):AddKeyPicker("SETTINGS.TOGGLEGUIKEYBIND", {
        Text = "Toggle GUI Keypicker",
        Default = "RightControl",
        NoUI = true
    })
    LinoriaLibrary.ToggleKeybind = Options["SETTINGS.TOGGLEGUIKEYBIND"]

    ThemeManager:SetLibrary(LinoriaLibrary)
    SaveManager:SetLibrary(LinoriaLibrary)

    SaveManager:IgnoreThemeSettings()
    SaveManager:SetIgnoreIndexes({"SETTINGS.TOGGLEGUIKEYBIND"})

    ThemeManager:SetFolder("ASYExploit")
    SaveManager:SetFolder("ASYExploit/" .. tostring(gameFolderName))

    ThemeManager:ApplyToTab(tab)
    SaveManager:BuildConfigSection(tab)

    return tab, menuBox
end


return GUIManager
